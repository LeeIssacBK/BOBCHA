package visitcount;

import javax.servlet.http.HttpSession;
import javax.servlet.http.HttpSessionEvent;
import javax.servlet.http.HttpSessionListener;

public class VisitSessionListener implements HttpSessionListener {

	@Override
	public void sessionCreated(HttpSessionEvent se) {
		//세션이 새로 생성되면 execute()를 실행함
		if(se.getSession().isNew()) {
			execute(se);
		}
	}
	
	private void execute(HttpSessionEvent se) {
		VisitCountDAO dao = dao.setTotalCount();
		int totalCount = dao.getTotalCount();
		int todayCount = dao.getTodayCount();
		
		HttpSession session = se.getSession();
		
		session.setAttribute("totalCount", totalCount);
		session.setAttribute("todayCount", todayCount);
	}
	

	@Override
	public void sessionDestroyed(HttpSessionEvent se) {}

}
